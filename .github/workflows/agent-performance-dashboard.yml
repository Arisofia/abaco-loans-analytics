name: Agent Performance Monitoring
on:
    schedule:
        - cron: "0 */6 * * *" # Every 6 hours
    workflow_dispatch:

env:
    OPIK_TOKEN: ${{ secrets.OPIK_TOKEN }}
    PHOENIX_TOKEN: ${{ secrets.PHOENIX_TOKEN }}
    FIGMA_TOKEN: ${{ secrets.FIGMA_TOKEN }}

jobs:
    monitor:
        runs-on: ubuntu-latest
        steps:
            - name: Query Opik for Agent Metrics
              run: |
                  python scripts/query_opik_metrics.py
            - name: Query Phoenix for Model Performance
              run: |
                  python scripts/query_phoenix_performance.py
            - name: Calculate Agent Health Scores
              run: |
                  python scripts/calculate_agent_health.py
            - name: Detect Degradation
              run: |
                  python scripts/detect_degradation.py
            - name: Update Figma Agent Health Dashboard
              run: |
                  python scripts/update_figma_agent_dashboard.py
            - name: Post Summary to Slack #ops-alerts
              run: |
                  python scripts/post_to_slack.py --channel "#ops-alerts"
